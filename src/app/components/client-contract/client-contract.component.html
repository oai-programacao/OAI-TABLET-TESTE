<div class="page-container">
  <app-card-base width="auto" height="auto">
    <p-divider>
      <div class="title">
        <h1>- CONTRATOS -</h1>
      </div>
    </p-divider>

    <div class="btn-to-create-another-contract">
      <p-button
        [rounded]="true"
        [raised]="true"
        (onClick)="navigateToInfoClient()"
        icon="pi pi-arrow-left"
        severity="danger"
      />
      <p-button
        [raised]="true"
        label="Criar Contrato"
        (onClick)="navigateToCreatContract()"
        icon="pi pi-plus"
        severity="success"
      />
    </div>

    <div class="infolegends">
      <p><span class="status-dot active"></span> Ativo</p>
      <p><span class="status-dot waiting"></span> Aguardando InstalaÃ§Ã£o</p>
      <p><span class="status-dot canceled"></span> Cancelado</p>
      <p><span class="status-dot blocked"></span> Bloqueado</p>
      <p><span class="status-dot transfer"></span> Transferido</p>
    </div>

    <div class="headerlist">
      <p-button
        [raised]="true"
        label="Somente Ativos"
        (onClick)="listActivesContracts()"
        icon="pi pi-list"
        severity="info"
      />
      <p-button
        [raised]="true"
        label="Visualizar todos"
        (onClick)="listToAllContracts()"
        icon="pi pi-list"
        severity="secondary"
      />
      <p-button
        [raised]="true"
        label="Bloqueados"
        (onClick)="listBlockedsContracts()"
        icon="pi pi-list"
        severity="secondary"
      />
      <p-button
        [raised]="true"
        label="Transferidos"
        (onClick)="listTransferContracts()"
        icon="pi pi-list"
        severity="secondary"
      />
    </div>

    <div class="contracts-list">
      @if (contracts.length === 0) {
      <div class="no-contracts">
        ğŸš« NÃƒO HÃ CONTRATOS CADASTRADO COM ESSE STATUS ğŸš«
      </div>
      } @else { @for (contract of contracts; track $index) {
      <div class="contract-card">
        <div class="contract-info">
          <div class="wrapper status-wrapper">
            <div class="status">
              <span
                class="status-dot"
                [ngClass]="{
                  active: contract.situationDescription == 'ATIVO',
                  waiting:
                    contract.situationDescription == 'AGUARDANDO_INSTALACAO',
                  blocked: contract.situationDescription == 'BLOQUEADO',
                  transfer: contract.situationDescription == 'TRANSFERIDO'
                }"
              ></span>
              <label
                >[{{ contract.situationDescription }}] NÂ° Contrato ğŸ“œ (RBX)
                â†’</label
              >
              <span>{{ contract.codeContractRbx }}</span>
            </div>
          </div>

          <div class="addresscontract">
            <!-- Plano -->
            <div class="section">
              <label>ğŸ“¦ Plano:</label>
              <span>{{ contract.planId }} | {{ contract.planName }}</span>
            </div>

            <!-- EndereÃ§o -->
            <div class="section">
              <label>ğŸ“ EndereÃ§o:</label>
              <span>{{ contract.street }}, {{ contract.number }}</span>
            </div>

            <!-- Bairro e CEP -->
            <div class="section">
              <label>ğŸ˜ï¸ Bairro:</label>
              <span>{{ contract.neighborhood }}</span>
              <label>ğŸ“ª CEP:</label>
              <span>{{ contract.zipCode }}</span>
            </div>

            <!-- EndereÃ§o + VigÃªncia + Vencimento + Dia Base -->
            <div class="section section-inline">
              <div class="group">
                <label>ğŸŒ† Cidade:</label>
                <span>{{ contract.city }}, {{ contract.state }}</span>
              </div>

              <div class="group">
                <label>VigÃªncia:</label>
                <span>{{ contract.vigencia }} </span>
              </div>

              <div class="group">
                <label>Dia Base:</label>
                <span>{{ contract.cicleBillingDayBase }}</span>
              </div>

              <div class="group">
                <label>Dia Vencimento:</label>
                <span>{{ contract.cicleBillingExpired }}</span>
              </div>
            </div>

            <!-- Valores -->
            <div class="section">
              <label>ğŸ’° Valor Bruto:</label>
              <span>{{ contract.brutePrice | currency : "BRL" }}</span>
              <label>ğŸ’¸ Desconto:</label>
              <span>{{ contract.descountFixe | currency : "BRL" }}</span>
              <label>ğŸ’µ Valor LÃ­quido:</label>
              <span>{{ contract.liquidPrice | currency : "BRL" }}</span>
            </div>

            <div class="section">
              <label>InÃ­cio:</label>
              <span>{{ contract.dateStart | date : "dd/MM/yyyy" }}</span>

              <label>Assinatura:</label>
              <span>{{ contract.dateSignature | date : "dd/MM/yyyy" }}</span>
            </div>
          </div>
        </div>

        <div class="contract-actions">
          <p-button
            icon="pi pi-arrow-up"
            (onClick)="openUpgradeDialog()"
            severity="success"
            [rounded]="true"
            [text]="true"
          />
          <p-button
            icon="pi pi-arrow-down"
            (onClick)="openDowngradeDialog()"
            severity="danger"
            [rounded]="true"
            [text]="true"
          />
          <p-button
            icon="pi pi-home"
            (onClick)="navigateToAddressTransfer()"
            severity="warn"
            [rounded]="true"
            [text]="true"
          />
        </div>
      </div>
      } }
    </div>
  </app-card-base>
</div>

<p-dialog
  header="Upgrade"
  [modal]="true"
  (onHide)="onHide()"
  [(visible)]="upgradeDialog"
  [style]="{ width: '35rem' }"
  [draggable]="false"
>
  <div class="dialog-container">
    <div class="plan-title">
      <span></span>
    </div>
    <form>
      <div class="father-form">
        <div class="select-dialog">
          <p-select
            placeholder="Selecionar Vendedor"
            appendTo="body"
            optionLabel="name"
            name="seller"
            required
          ></p-select>
        </div>
        <div class="select-dialog">
          <p-select
            placeholder="Selecionar Plano"
            appendTo="body"
            optionLabel="plan"
            name="plan"
            required
          ></p-select>
        </div>
      </div>
      <div class="btn-to-send-new-contract">
        <p-button label="Enviar" type="submit"></p-button>
      </div>
    </form>
  </div>
</p-dialog>
<!-- UPGRADE -->
<p-dialog
  header="Upgrade"
  [modal]="true"
  (onHide)="onHide()"
  [(visible)]="upgradeDialog"
  [style]="{ width: '35rem' }"
  [draggable]="false"
>
  <div class="dialog-container">
    <div>
      <span></span>
    </div>

    <form>
      <div class="father-form">
        <div class="select-dialog">
          <p-select
            placeholder="Selecionar Vendedor"
            appendTo="body"
            optionLabel="name"
            name="seller"
            required
          ></p-select>
        </div>

        <div class="select-dialog">
          <p-select
            placeholder="Selecionar Plano"
            appendTo="body"
            optionLabel="plan"
            name="plan"
            required
          ></p-select>
        </div>
      </div>

      <div class="btn-to-send-new-contract">
        <p-button label="Enviar" type="submit"></p-button>
      </div>
    </form>
  </div>
</p-dialog>

<!-- DOWNGRADE -->
<p-dialog
  header="Downgrade"
  [modal]="true"
  (onHide)="onHide()"
  [(visible)]="downgradeDialog"
  [style]="{ width: '35rem' }"
  [draggable]="false"
>
  <div class="dialog-container">
    <div class="plan-title">
      <span></span>
    </div>

    <form>
      <div class="father-form">
        <div class="select-dialog">
          <p-select
            placeholder="Selecionar Vendedor"
            appendTo="body"
            optionLabel="name"
            name="seller"
            required
          ></p-select>
        </div>

        <div class="select-dialog">
          <p-select
            placeholder="Selecionar Plano"
            appendTo="body"
            optionLabel="plan"
            name="plan"
            required
          ></p-select>
        </div>
      </div>

      <div class="btn-to-send-new-contract">
        <p-button label="Enviar" type="submit"></p-button>
      </div>
    </form>
  </div>
</p-dialog>

<p-toast />
