<div class="card-wrapper">
  <app-card-base width="auto" height="auto">
    <div class="btn-to-back">
      <p-button
        icon="pi pi-arrow-left"
        [rounded]="true"
        severity="danger"
        size="large"
        [raised]="true"
        (onClick)="navigateBackToClientInfo()"
      />
      <p-button
        severity="info"
        icon="pi pi-home"
        size="large"
        raised="true"
        [rounded]="true"
        (onClick)="goToHome()"
      />
    </div>

    <div class="container">
      <p-divider class="title">
        <h1 class="title">Documentos do Cliente</h1>
      </p-divider>

      <div class="btn-to-add-images">
        <div class="upload-btn-wrapper">
          <p-button
            styleClass="btn-frente"
            iconPos="top"
            size="large"
            severity="info"
            (onClick)="openFileInput('frente')"
          />
          <div
            class="uploaded-label"
            *ngIf="images[0].src !== defaultImage.src"
          >
            <i class="pi pi-check-square"></i>
            Documento Frente carregado
          </div>
        </div>

        <div class="upload-btn-wrapper">
          <p-button
            styleClass="btn-verso"
            iconPos="top"
            size="large"
            severity="info"
            (onClick)="openFileInput('verso')"
          />
          <div
            class="uploaded-label"
            *ngIf="images[1].src !== defaultImage.src"
          >
            <i class="pi pi-check-square"></i>
            Documento Verso carregado
          </div>
        </div>
      </div>

      <div class="images-grid">
        <div
          class="image-slot"
          *ngFor="let img of images; let i = index"
          [class.default-slot]="img.src === defaultImage.src"
          (click)="i > 1 ? selectSlot(i) : null"
        >
          <img
            [src]="img.src"
            [alt]="img.alt"
            [class.default-image]="img.src === defaultImage.src"
          />

          <button
            *ngIf="img.src !== defaultImage.src"
            type="button"
            class="remove-btn"
            (click)="removeImage(i); $event.stopPropagation()"
          >
            <i class="pi pi-times"></i>
          </button>

          <p *ngIf="img.type">{{ img.alt }}</p>

          <!-- overlay + sÃ³ nos quadrados extras vazios -->
          <div
            *ngIf="img.src === defaultImage.src && i > 1"
            class="overlay-plus"
            (click)="selectSlot(i); $event.stopPropagation()"
          >
            +
          </div>
        </div>
      </div>

      <input
        type="file"
        #fileInput
        style="display: none"
        (change)="onFileSelected($event)"
        accept="image/*"
      />

      <!-- preview -->
      <p-dialog
        [(visible)]="previewVisible"
        modal="true"
        [closable]="true"
        [style]="{ width: '400px' }"
      >
        <img
          [src]="previewImage"
          alt="Preview"
          style="width: 100%; height: auto"
        />
      </p-dialog>
    </div>

    <div class="btns">
      <p-button
        label="Confirmar"
        severity="success"
        icon="pi pi-check"
        [raised]="true"
        size="large"
        (onClick)="confirm1($event)"
      />
    </div>
  </app-card-base>
</div>

<p-toast></p-toast>
<p-confirmdialog></p-confirmdialog>
