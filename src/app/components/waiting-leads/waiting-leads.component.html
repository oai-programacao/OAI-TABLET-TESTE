<div class="leads-container">
  <app-card-base
    header="üì¶ Gest√£o de Vendas Arquivadas"
    width="auto"
    height="auto"
  >
    <div class="btn-to-back">
      <p-button
        icon="pi pi-arrow-left"
        [rounded]="true"
        severity="danger"
        [size]="'large'"
        (onClick)="backToSearch()"
      >
      </p-button>
    </div>

    <div class="header-card">
      <!-- Card 1: Total de Vendas -->
      <div class="rainbow-wrapper">
        <div class="header-content">
          <i class="pi pi-box header-icon"></i>
          <div class="header-text">
            <h2>Vendas Arquivadas</h2>
            <p>Total de vendas arquivadas</p>
          </div>
          <div class="totalizer">
            <span class="value">{{ archivedSales.length }}</span>
            <span class="label">Vendas</span>
          </div>
        </div>
      </div>

      <!-- Card 2: Clientes Diferentes -->
      <div class="rainbow-wrapper">
        <div class="header-content">
          <i class="pi pi-users header-icon"></i>
          <div class="header-text">
            <h2>Clientes</h2>
            <p>Total de clientes distintos</p>
          </div>
          <div class="totalizer">
            <span class="value">{{ totalUniqueClients }}</span>
            <span class="label">Clientes</span>
          </div>
        </div>
      </div>

      <!-- Card 3: Planos Diferentes -->
      <div class="rainbow-wrapper">
        <div class="header-content">
          <i class="pi pi-tag header-icon"></i>
          <div class="header-text">
            <h2>Planos</h2>
            <p>Total de planos diferentes</p>
          </div>
          <div class="totalizer">
            <span class="value">{{ totalUniquePlans }}</span>
            <span class="label">Planos</span>
          </div>
        </div>
      </div>
    </div>

    <div class="container">
      <div *ngIf="isLoading" class="loading-container">
        <p-progressSpinner></p-progressSpinner>
        <p>Carregando vendas arquivadas...</p>
      </div>

      <div *ngIf="!isLoading && archivedSales.length === 0" class="empty-state">
        <i class="pi pi-inbox" style="font-size: 4rem; color: #ccc"></i>
        <h3>Nenhuma venda arquivada</h3>
        <p>As vendas arquivadas aparecer√£o aqui.</p>
      </div>

      <div
        *ngIf="!isLoading && archivedSales.length > 0"
        class="card-container"
      >
        <app-card-leads
          *ngFor="let sale of archivedSales"
          [data]="transformToCardData(sale)"
          (onCall)="callClient(sale.clientPhone || '')"
          (onEmail)="sendEmail(sale.clientEmail || '')"
          (onDelete)="deleteSale(sale)"
        >
        </app-card-leads>
      </div>
    </div>
  </app-card-base>
</div>
